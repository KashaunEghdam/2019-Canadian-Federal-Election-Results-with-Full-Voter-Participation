#### Preamble ####
# Purpose: to display how table 4 was calculated

cell_counts_1 <- cell_counts %>%filter(age %in% c("18 to 29"))
cell_counts_2 <- cell_counts %>%filter(age %in% c("30 to 39"))
cell_counts_3 <- cell_counts %>%filter(age %in% c("40 to 49"))
cell_counts_4 <- cell_counts %>%filter(age %in% c("50 to 59"))
cell_counts_5 <- cell_counts %>%filter(age %in% c("60+"))
cell_counts_6 <- cell_counts %>%filter(gender %in% c("Male"))
cell_counts_7 <- cell_counts %>%filter(gender %in% c("Female"))
cell_counts_8 <- cell_counts %>%filter(education %in% c("less than high school diploma"))
cell_counts_9 <- cell_counts %>%filter(education %in% c("Completed secondary/high school"))
cell_counts_10 <- cell_counts %>%filter(education %in% c("Completed college or equivalent"))
cell_counts_11 <- cell_counts %>%filter(education %in% c("Bachleor's degree"))
cell_counts_12 <- cell_counts %>%filter(education %in% c("Univeristy degree above Bachleor's degree"))
cell_counts_13 <- cell_counts %>%filter(children %in% c("Yes"))
cell_counts_14 <- cell_counts %>%filter(children %in% c("No"))
cell_counts_15 <- cell_counts %>%filter(marital_status %in% c("Never Married"))
cell_counts_16 <- cell_counts %>%filter(marital_status %in% c("Living with a partner"))
cell_counts_17 <- cell_counts %>%filter(marital_status %in% c("Separated"))
cell_counts_18 <- cell_counts %>%filter(marital_status %in% c("Married"))
cell_counts_19 <- cell_counts %>%filter(marital_status %in% c("Divorced"))
cell_counts_20 <- cell_counts %>%filter(marital_status %in% c("Widowed"))

L_pv_1 <- cell_counts_1 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_11 <- 100*(sum(L_pv_1$n))/(sum(cell_counts_1$n))
C_pv_1 <- cell_counts_1 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_11 <- 100*sum(C_pv_1$n)/sum(cell_counts_1$n)
N_pv_1 <- cell_counts_1 %>% filter(vote_2019 %in% c("NDP"))
N_pv_11 <- 100*sum(N_pv_1$n)/sum(cell_counts_1$n)
B_pv_1 <- cell_counts_1 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_11 <- 100*sum(B_pv_1$n)/sum(cell_counts_1$n)
G_pv_1 <- cell_counts_1 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_11 <- 100*sum(G_pv_1$n)/sum(cell_counts_1$n)

L_pv_2 <- cell_counts_2 %>% filter(vote_2019 %in% c(".Liberal Party"))
L_pv_21 <- 100*sum(L_pv_2$n)/sum(cell_counts_2$n)
C_pv_2 <- cell_counts_2 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_21 <- 100*sum(C_pv_2$n)/sum(cell_counts_2$n)
N_pv_2 <- cell_counts_2 %>% filter(vote_2019 %in% c("NDP"))
N_pv_21 <- 100*sum(N_pv_2$n)/sum(cell_counts_2$n)
B_pv_2 <- cell_counts_2 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_21 <- 100*sum(B_pv_2$n)/sum(cell_counts_2$n)
G_pv_2 <- cell_counts_2 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_21 <- 100*sum(G_pv_2$n)/sum(cell_counts_2$n)

L_pv_3 <- cell_counts_3 %>% filter(vote_2019 %in% c(".Liberal Party"))
L_pv_31 <- 100*sum(L_pv_3$n)/sum(cell_counts_3$n)
C_pv_3 <- cell_counts_3 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_31 <- 100*sum(C_pv_3$n)/sum(cell_counts_3$n)
N_pv_3 <- cell_counts_3 %>% filter(vote_2019 %in% c("NDP"))
N_pv_31 <- 100*sum(N_pv_3$n)/sum(cell_counts_3$n)
B_pv_3 <- cell_counts_3 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_31 <- 100*sum(B_pv_3$n)/sum(cell_counts_3$n)
G_pv_3 <- cell_counts_3 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_31 <- 100*sum(G_pv_3$n)/sum(cell_counts_3$n)

L_pv_4 <- cell_counts_4 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_41 <- 100*sum(L_pv_4$n)/sum(cell_counts_4$n)
C_pv_4 <- cell_counts_4 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_41 <- 100*sum(C_pv_4$n)/sum(cell_counts_4$n)
N_pv_4 <- cell_counts_4 %>% filter(vote_2019 %in% c("NDP"))
N_pv_41 <- 100*sum(N_pv_4$n)/sum(cell_counts_4$n)
B_pv_4 <- cell_counts_4 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_41 <- 100*sum(B_pv_4$n)/sum(cell_counts_4$n)
G_pv_4 <- cell_counts_4 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_41 <- 100*sum(G_pv_4$n)/sum(cell_counts_4$n)

L_pv_5 <- cell_counts_5 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_51 <- 100*sum(L_pv_5$n)/sum(cell_counts_5$n)
C_pv_5 <- cell_counts_5 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_51 <- 100*sum(C_pv_5$n)/sum(cell_counts_5$n)
N_pv_5 <- cell_counts_5 %>% filter(vote_2019 %in% c("NDP"))
N_pv_51 <- 100*sum(N_pv_5$n)/sum(cell_counts_5$n)
B_pv_5 <- cell_counts_5 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_51 <- 100*sum(B_pv_5$n)/sum(cell_counts_5$n)
G_pv_5 <- cell_counts_5 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_51 <- 100*sum(G_pv_5$n)/sum(cell_counts_5$n)

L_pv_6 <- cell_counts_6 %>% filter(vote_2019 %in% c(".Liberal Party"))
L_pv_61 <- 100*sum(L_pv_6$n)/sum(cell_counts_6$n)
C_pv_6 <- cell_counts_6 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_61 <- 100*sum(C_pv_6$n)/sum(cell_counts_6$n)
N_pv_6 <- cell_counts_6 %>% filter(vote_2019 %in% c("NDP"))
N_pv_61 <- 100*sum(N_pv_6$n)/sum(cell_counts_6$n)
B_pv_6 <- cell_counts_6 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_61 <- 100*sum(B_pv_6$n)/sum(cell_counts_6$n)
G_pv_6 <- cell_counts_6 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_61 <- 100*sum(G_pv_6$n)/sum(cell_counts_6$n)

L_pv_7 <- cell_counts_7 %>% filter(vote_2019 %in% c(".Liberal Party"))
L_pv_71 <- 100*sum(L_pv_7$n)/sum(cell_counts_7$n)
C_pv_7 <- cell_counts_7 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_71 <- 100*sum(C_pv_7$n)/sum(cell_counts_7$n)
N_pv_7 <- cell_counts_7 %>% filter(vote_2019 %in% c("NDP"))
N_pv_71 <- 100*sum(N_pv_7$n)/sum(cell_counts_7$n)
B_pv_7 <- cell_counts_7 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_71 <- 100*sum(B_pv_7$n)/sum(cell_counts_7$n)
G_pv_7 <- cell_counts_7 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_71 <- 100*sum(G_pv_7$n)/sum(cell_counts_7$n)

L_pv_8 <- cell_counts_8 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_81 <- 100*sum(L_pv_8$n)/sum(cell_counts_8$n)
C_pv_8 <- cell_counts_8 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_81 <- 100*sum(C_pv_8$n)/sum(cell_counts_8$n)
N_pv_8 <- cell_counts_8 %>% filter(vote_2019 %in% c("NDP"))
N_pv_81 <- 100*sum(N_pv_8$n)/sum(cell_counts_8$n)
B_pv_8 <- cell_counts_8 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_81 <- 100*sum(B_pv_8$n)/sum(cell_counts_8$n)
G_pv_8 <- cell_counts_8 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_81 <- 100*sum(G_pv_8$n)/sum(cell_counts_8$n)

L_pv_9 <- cell_counts_9 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_91 <- 100*sum(L_pv_9$n)/sum(cell_counts_9$n)
C_pv_9 <- cell_counts_9 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_91 <- 100*sum(C_pv_9$n)/sum(cell_counts_9$n)
N_pv_9 <- cell_counts_9 %>% filter(vote_2019 %in% c("NDP"))
N_pv_91 <- 100*sum(N_pv_9$n)/sum(cell_counts_9$n)
B_pv_9 <- cell_counts_9 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_91 <- 100*sum(B_pv_9$n)/sum(cell_counts_9$n)
G_pv_9 <- cell_counts_9 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_91 <- 100*sum(G_pv_9$n)/sum(cell_counts_9$n)

L_pv_10 <- cell_counts_10 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_101 <- 100*sum(L_pv_10$n)/sum(cell_counts_10$n)
C_pv_10 <- cell_counts_10 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_101 <- 100*sum(C_pv_10$n)/sum(cell_counts_10$n)
N_pv_10 <- cell_counts_10 %>% filter(vote_2019 %in% c("NDP"))
N_pv_101 <- 100*sum(N_pv_10$n)/sum(cell_counts_10$n)
B_pv_10 <- cell_counts_10 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_101 <- 100*sum(B_pv_10$n)/sum(cell_counts_10$n)
G_pv_10 <- cell_counts_10 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_101 <- 100*sum(G_pv_10$n)/sum(cell_counts_10$n)

L_pv_011 <- cell_counts_11 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_111 <- 100*(sum(L_pv_011$n))/(sum(cell_counts_11$n))
C_pv_011 <- cell_counts_11 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_111 <- 100*sum(C_pv_011$n)/sum(cell_counts_11$n)
N_pv_011 <- cell_counts_11 %>% filter(vote_2019 %in% c("NDP"))
N_pv_111 <- 100*sum(N_pv_011$n)/sum(cell_counts_11$n)
B_pv_011 <- cell_counts_11 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_111 <- 100*sum(B_pv_011$n)/sum(cell_counts_11$n)
G_pv_011 <- cell_counts_11 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_111 <- 100*sum(G_pv_011$n)/sum(cell_counts_11$n)

L_pv_12 <- cell_counts_12 %>% filter(vote_2019 %in% c(".Liberal Party"))
L_pv_121 <- 100*sum(L_pv_12$n)/sum(cell_counts_12$n)
C_pv_12 <- cell_counts_12 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_121 <- 100*sum(C_pv_12$n)/sum(cell_counts_12$n)
N_pv_12 <- cell_counts_12 %>% filter(vote_2019 %in% c("NDP"))
N_pv_121 <- 100*sum(N_pv_12$n)/sum(cell_counts_12$n)
B_pv_12 <- cell_counts_12 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_121 <- 100*sum(B_pv_12$n)/sum(cell_counts_12$n)
G_pv_12 <- cell_counts_12 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_121 <- 100*sum(G_pv_12$n)/sum(cell_counts_12$n)

L_pv_13 <- cell_counts_13 %>% filter(vote_2019 %in% c(".Liberal Party"))
L_pv_131 <- 100*sum(L_pv_13$n)/sum(cell_counts_13$n)
C_pv_13 <- cell_counts_13 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_131 <- 100*sum(C_pv_13$n)/sum(cell_counts_13$n)
N_pv_13 <- cell_counts_13 %>% filter(vote_2019 %in% c("NDP"))
N_pv_131 <- 100*sum(N_pv_13$n)/sum(cell_counts_13$n)
B_pv_13 <- cell_counts_13 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_131 <- 100*sum(B_pv_13$n)/sum(cell_counts_13$n)
G_pv_13 <- cell_counts_13 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_131 <- 100*sum(G_pv_13$n)/sum(cell_counts_13$n)

L_pv_14 <- cell_counts_14 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_141 <- 100*sum(L_pv_14$n)/sum(cell_counts_14$n)
C_pv_14 <- cell_counts_14 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_141 <- 100*sum(C_pv_14$n)/sum(cell_counts_14$n)
N_pv_14 <- cell_counts_14 %>% filter(vote_2019 %in% c("NDP"))
N_pv_141 <- 100*sum(N_pv_14$n)/sum(cell_counts_14$n)
B_pv_14 <- cell_counts_14 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_141 <- 100*sum(B_pv_14$n)/sum(cell_counts_14$n)
G_pv_14 <- cell_counts_14 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_141 <- 100*sum(G_pv_14$n)/sum(cell_counts_14$n)

L_pv_15 <- cell_counts_15 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_151 <- 100*sum(L_pv_15$n)/sum(cell_counts_15$n)
C_pv_15 <- cell_counts_15 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_151 <- 100*sum(C_pv_15$n)/sum(cell_counts_15$n)
N_pv_15 <- cell_counts_15 %>% filter(vote_2019 %in% c("NDP"))
N_pv_151 <- 100*sum(N_pv_15$n)/sum(cell_counts_15$n)
B_pv_15 <- cell_counts_15 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_151 <- 100*sum(B_pv_15$n)/sum(cell_counts_15$n)
G_pv_15 <- cell_counts_15 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_151 <- 100*sum(G_pv_15$n)/sum(cell_counts_15$n)

L_pv_16 <- cell_counts_16 %>% filter(vote_2019 %in% c(".Liberal Party"))
L_pv_161 <- 100*sum(L_pv_16$n)/sum(cell_counts_16$n)
C_pv_16 <- cell_counts_16 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_161 <- 100*sum(C_pv_16$n)/sum(cell_counts_16$n)
N_pv_16 <- cell_counts_16 %>% filter(vote_2019 %in% c("NDP"))
N_pv_161 <- 100*sum(N_pv_16$n)/sum(cell_counts_16$n)
B_pv_16 <- cell_counts_16 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_161 <- 100*sum(B_pv_16$n)/sum(cell_counts_16$n)
G_pv_16 <- cell_counts_16 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_161 <- 100*sum(G_pv_16$n)/sum(cell_counts_16$n)

L_pv_17 <- cell_counts_17 %>% filter(vote_2019 %in% c(".Liberal Party"))
L_pv_171 <- 100*sum(L_pv_17$n)/sum(cell_counts_17$n)
C_pv_17 <- cell_counts_17 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_171 <- 100*sum(C_pv_17$n)/sum(cell_counts_17$n)
N_pv_17 <- cell_counts_17 %>% filter(vote_2019 %in% c("NDP"))
N_pv_171 <- 100*sum(N_pv_17$n)/sum(cell_counts_17$n)
B_pv_17 <- cell_counts_17 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_171 <- 100*sum(B_pv_17$n)/sum(cell_counts_17$n)
G_pv_17 <- cell_counts_17 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_171 <- 100*sum(G_pv_17$n)/sum(cell_counts_17$n)

L_pv_18 <- cell_counts_18 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_181 <- 100*sum(L_pv_18$n)/sum(cell_counts_18$n)
C_pv_18 <- cell_counts_18 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_181 <- 100*sum(C_pv_18$n)/sum(cell_counts_18$n)
N_pv_18 <- cell_counts_18 %>% filter(vote_2019 %in% c("NDP"))
N_pv_181 <- 100*sum(N_pv_18$n)/sum(cell_counts_18$n)
B_pv_18 <- cell_counts_18 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_181 <- 100*sum(B_pv_18$n)/sum(cell_counts_18$n)
G_pv_18 <- cell_counts_18 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_181 <- 100*sum(G_pv_18$n)/sum(cell_counts_18$n)

L_pv_19 <- cell_counts_19 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_191 <- 100*sum(L_pv_19$n)/sum(cell_counts_19$n)
C_pv_19 <- cell_counts_19 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_191 <- 100*sum(C_pv_19$n)/sum(cell_counts_19$n)
N_pv_19 <- cell_counts_19 %>% filter(vote_2019 %in% c("NDP"))
N_pv_191 <- 100*sum(N_pv_19$n)/sum(cell_counts_19$n)
B_pv_19 <- cell_counts_19 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_191 <- 100*sum(B_pv_19$n)/sum(cell_counts_19$n)
G_pv_19 <- cell_counts_19 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_191 <- 100*sum(G_pv_19$n)/sum(cell_counts_19$n)

L_pv_20 <- cell_counts_20 %>% filter(vote_2019 %in% c(".Liberal Party")) 
L_pv_201 <- 100*sum(L_pv_20$n)/sum(cell_counts_20$n)
C_pv_20 <- cell_counts_20 %>% filter(vote_2019 %in% c("Conservative Party"))
C_pv_201 <- 100*sum(C_pv_20$n)/sum(cell_counts_20$n)
N_pv_20 <- cell_counts_10 %>% filter(vote_2019 %in% c("NDP"))
N_pv_201 <- 100*sum(N_pv_20$n)/sum(cell_counts_20$n)
B_pv_20 <- cell_counts_20 %>% filter(vote_2019 %in% c("Bloc Quebecois"))
B_pv_201 <- 100*sum(B_pv_20$n)/sum(cell_counts_20$n)
G_pv_20 <- cell_counts_20 %>% filter(vote_2019 %in% c("Green Party"))
G_pv_201 <- 100*sum(G_pv_20$n)/sum(cell_counts_20$n)

results_provinces1 <- matrix(c("",52.0,63.2,57.2,48.2,52.9,"",45.4,61.6,"",31.8,45.0,46.1,74.8,85.9,"",50.0,65.8,"",64.8,59.7,71.6,45.1,65.8,53.2,
                               "",20.1,33,40.3,45.7,36.4,"",46.5,27.7,"",42.3,42.3,45.3,23.6,13.5,"",42.4,21.2,"",17.3,21.8,18.3,51.4,27.1,33.9,
                               "",0,0.1,1.0,6.0,10.7,"",6.2,4.8,"",21.9,5.7,3.9,0.3,0.2,"",6.9,2.1,"",4.1,10.9,6.8,3.3,6.0,12.8,
                               "",24.3,3.2,1.3,0.1,0,"",1.4,5.3,"", 3.5,6.1,4.0,1.4,0.4,"",1.0,9.7,"",12.8,5.2,2.4,0.2,0.8,0.11,
                               "",3.6,0.5,0.2,0,0,"",0.5,0.5,"",0.4,0.9,0.7,0,0,"",0.2,1.2,"",1.0,2.3,0.8,0,0.3,0), ncol=5)
rownames(results_provinces1) <- c("Age","18 to 29","30 to 39","40 to 49","50 to 59", "60+","Gender","Male","Female","Education","less than high school diploma",
                                  "Completed secondary/ high school","Completed college or equivalent","Bachelor's degree","Univeristy degree above Bachelor's degree",
                                  "Children","Has Children","Does not have Children","Marital Status","Never Married",
                                  "Living with a partner","Serparated","Married","Divorced","Widowed")
colnames(results_provinces1) <- c("Liberal Party  ", "Conservative Party  ","Bloc Quebecois  ","  NDP     ","Green Party ")
results.table.province1 <- as.table(results_provinces1)
results.table.province1 %>%
  kbl() %>%
  kable_styling() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>%
  add_indent(c(1, 7, 10,16,19))